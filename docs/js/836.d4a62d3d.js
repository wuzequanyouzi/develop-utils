"use strict";(self["webpackChunkdocs_site"]=self["webpackChunkdocs_site"]||[]).push([[836],{4836:function(s,a,l){l.r(a),l.d(a,{default:function(){return g}});var n=l(3396);const e=(0,n._)("h2",null,"前言",-1),c=(0,n._)("p",null,"笔者接触CesiumJS是由于公司项目需要，直接边学边开发，两三个月来都挺顺风顺水的。直到数据量越来越大，地图上的实体越来越多，首屏加载的时候经常会卡顿，客户那边的机器性能太差，有时候卡顿的同时还出现浏览器无响应问题。测试把这个问题归为BUG，要求必须解决，搞得我头大。",-1),t=(0,n._)("h2",null,"加载成百上千实体时出现的问题",-1),p=(0,n._)("p",null,"让我们先来看下加载Label实体出现了什么问题？",-1),r=(0,n._)("pre",null,[(0,n._)("code",{"v-pre":"",class:"language-js"},[(0,n._)("span",{class:"hljs-keyword"},"function"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title function_"},"addBillboard"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-params"},"bsm, name, buildingType, position"),(0,n.Uk)(") {\n    "),(0,n._)("span",{class:"hljs-variable language_"},"this"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"viewer"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"entities"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"add"),(0,n.Uk)("({\n        "),(0,n._)("span",{class:"hljs-attr"},"id"),(0,n.Uk)(": bsm,\n        name,\n        "),(0,n._)("span",{class:"hljs-attr"},"position"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-title class_"},"Cartesian3"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"fromDegrees"),(0,n.Uk)("(position["),(0,n._)("span",{class:"hljs-number"},"0"),(0,n.Uk)("], position["),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)("], position["),(0,n._)("span",{class:"hljs-number"},"2"),(0,n.Uk)("]),\n        "),(0,n._)("span",{class:"hljs-attr"},"label"),(0,n.Uk)(": {\n          "),(0,n._)("span",{class:"hljs-attr"},"text"),(0,n.Uk)(": name,\n          "),(0,n._)("span",{class:"hljs-attr"},"font"),(0,n.Uk)(": style == "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(" ? "),(0,n._)("span",{class:"hljs-string"},"'500 40px Microsoft YaHei'"),(0,n.Uk)(" : "),(0,n._)("span",{class:"hljs-string"},"'500 30px Helvetica'"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-comment"},"// 15pt monospace"),(0,n.Uk)("\n          "),(0,n._)("span",{class:"hljs-attr"},"outlineColor"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-title class_"},"Color"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"WHITE"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-comment"},"// 边框颜色"),(0,n.Uk)("\n          "),(0,n._)("span",{class:"hljs-attr"},"outlineWidth"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-comment"},"// 边框宽度"),(0,n.Uk)("\n          "),(0,n._)("span",{class:"hljs-attr"},"scale"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-number"},"0.5"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"style"),(0,n.Uk)(": style == "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(" ? "),(0,n._)("span",{class:"hljs-title class_"},"LabelStyle"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"FILL_AND_OUTLINE"),(0,n.Uk)(" : "),(0,n._)("span",{class:"hljs-title class_"},"LabelStyle"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"FILL"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"fillColor"),(0,n.Uk)(": style == "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(" ? "),(0,n._)("span",{class:"hljs-title class_"},"Color"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"BLACK"),(0,n.Uk)(" : "),(0,n._)("span",{class:"hljs-title class_"},"Color"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"WHITE"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"pixelOffset"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"Cartesian2"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"110"),(0,n.Uk)(", -"),(0,n._)("span",{class:"hljs-number"},"70"),(0,n.Uk)("), "),(0,n._)("span",{class:"hljs-comment"},"// 偏移量"),(0,n.Uk)("\n          "),(0,n._)("span",{class:"hljs-attr"},"showBackground"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-literal"},"true"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"backgroundColor"),(0,n.Uk)(": backColor,\n          "),(0,n._)("span",{class:"hljs-attr"},"distanceDisplayCondition"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"DistanceDisplayCondition"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"10.0"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"8000.0"),(0,n.Uk)("),\n          "),(0,n._)("span",{class:"hljs-attr"},"disableDepthTestDistance"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-number"},"100.0"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"scaleByDistance"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"NearFarScalar"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"500"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1400"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"0.0"),(0,n.Uk)("),\n          "),(0,n._)("span",{class:"hljs-attr"},"translucencyByDistance"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"NearFarScalar"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"500"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1400"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"0.0"),(0,n.Uk)(")\n        },\n        "),(0,n._)("span",{class:"hljs-attr"},"billboard"),(0,n.Uk)(": {\n          "),(0,n._)("span",{class:"hljs-attr"},"image"),(0,n.Uk)(": buildingTypeImage,\n          "),(0,n._)("span",{class:"hljs-attr"},"width"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-number"},"300"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"height"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-number"},"140"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"pixelOffset"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"Cartesian2"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"90"),(0,n.Uk)(", -"),(0,n._)("span",{class:"hljs-number"},"25"),(0,n.Uk)("), "),(0,n._)("span",{class:"hljs-comment"},"// 偏移量"),(0,n.Uk)("\n          "),(0,n._)("span",{class:"hljs-attr"},"distanceDisplayCondition"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"DistanceDisplayCondition"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"10.0"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"2000.0"),(0,n.Uk)("),\n          "),(0,n._)("span",{class:"hljs-attr"},"disableDepthTestDistance"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-number"},"100.0"),(0,n.Uk)(",\n          "),(0,n._)("span",{class:"hljs-attr"},"scaleByDistance"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"NearFarScalar"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"500"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1400"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"0.0"),(0,n.Uk)("),\n          "),(0,n._)("span",{class:"hljs-attr"},"translucencyByDistance"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"NearFarScalar"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-number"},"500"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"1400"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"0.0"),(0,n.Uk)(")\n        },\n        "),(0,n._)("span",{class:"hljs-attr"},"properties"),(0,n.Uk)(": {\n          "),(0,n._)("span",{class:"hljs-attr"},"poiType"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-string"},"'buildingPOI'"),(0,n.Uk)(",\n          name,\n          buildingType,\n          bsm,\n          position\n        }\n      });\n}\n")])],-1),i=(0,n.uE)('<p>当我需要创建400多个上面这样的实体时，页面总会卡顿一段时间。于是我上网查找相关资料，可能我表述有问题，一直没找到我想要的答案。所以我进行了浏览器DevTools。</p><p><img src="https://pic.imgdb.cn/item/6523a287c458853aef452b93.jpg" alt="image.png"> 在加载地图的时候，js执行了4.75秒。。。。，公司电脑配置如下：</p><p><img src="https://pic.imgdb.cn/item/6523a27fc458853aef45295f.jpg" alt="image.png"> 性能不算差吧<br> 继续看Performance分析吧</p><p><img src="https://pic.imgdb.cn/item/6523a49ec458853aef45c28e.jpg" alt="image.png"> 这个getImageData怎么执行了2秒多，我当时想难道我传进去的图片Cesium要做其他的处理？ 于是我把实体的<code>billboard</code>属性剔除掉了。</p><p><img src="https://pic.imgdb.cn/item/6523a27fc458853aef452980.jpg" alt="image.png"> 少了20%的时间，噢，不对我已经没传图片进去了，<code>Cesium</code>依然调了<code>getImageData</code>，这就奇怪了，难道这是<code>Cesium</code>在生成图片，<code>entitie</code>属性只剩下label/position/properties/id/name了，除了label，其他都是纯数据的。难道label不是文本？<br></p><p>带着这个问题，我把实体的<code>label</code>属性也剔除掉了。进行了一次<code>Performance</code>。</p><p><img src="https://pic.imgdb.cn/item/6523a27fc458853aef45299a.jpg" alt="image.png"><code>getImageData</code>方法没有调用。</p><p><img src="https://pic.imgdb.cn/item/6523a287c458853aef452bb5.jpg" alt="image.png"> 至此，我断定<code>Cesium</code>在创建含有label的<code>entitie</code>时，会动态生成对应label.name值的图片。</p><h2>解决方案——自行动态生成图片</h2><p>找到问题，接下来就好办了，自己尝试构造这个label，不要用到Cesium的<code>Label</code>。原本项目中实体的<code>billboard</code>是一张<code>png</code>格式的底图。</p><p><img src="https://pic.imgdb.cn/item/6523a27fc458853aef452968.jpg" alt="image.png"><br><strong>思路: 使用Canvas绘制一张带有文本的图片，再将base64码给<code>entitie</code>的<code>billboard</code></strong><br></p>',11),_=(0,n._)("pre",null,[(0,n._)("code",{"v-pre":"",class:"language-js"},[(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" canvas = "),(0,n._)("span",{class:"hljs-variable language_"},"document"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"createElement"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'canvas'"),(0,n.Uk)(");\n"),(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" ctx = canvas."),(0,n._)("span",{class:"hljs-title function_"},"getContext"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'2d'"),(0,n.Uk)(");\n"),(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" image = "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"Image"),(0,n.Uk)("();\nimage."),(0,n._)("span",{class:"hljs-property"},"style"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"width"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-string"},"'400px'"),(0,n.Uk)(";\n"),(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" name = "),(0,n._)("span",{class:"hljs-string"},"'韭年'"),(0,n.Uk)(";\nimage."),(0,n._)("span",{class:"hljs-property"},"onload"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-function"},"() =>"),(0,n.Uk)(" {\n    canvas."),(0,n._)("span",{class:"hljs-property"},"width"),(0,n.Uk)(" = image."),(0,n._)("span",{class:"hljs-property"},"width"),(0,n.Uk)(";\n    canvas."),(0,n._)("span",{class:"hljs-property"},"height"),(0,n.Uk)(" = image."),(0,n._)("span",{class:"hljs-property"},"height"),(0,n.Uk)(";\n    ctx."),(0,n._)("span",{class:"hljs-title function_"},"drawImage"),(0,n.Uk)("(image, "),(0,n._)("span",{class:"hljs-number"},"0"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"0"),(0,n.Uk)(", image."),(0,n._)("span",{class:"hljs-property"},"width"),(0,n.Uk)(", image."),(0,n._)("span",{class:"hljs-property"},"height"),(0,n.Uk)(");\n    ctx."),(0,n._)("span",{class:"hljs-property"},"font"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-string"},"'bold 20px Arial'"),(0,n.Uk)(";\n    ctx."),(0,n._)("span",{class:"hljs-property"},"textAlign"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-string"},"'center'"),(0,n.Uk)(";\n    ctx."),(0,n._)("span",{class:"hljs-property"},"textBaseline"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-string"},"'bottom'"),(0,n.Uk)(";\n    ctx."),(0,n._)("span",{class:"hljs-property"},"fillStyle"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-string"},"'#FFF'"),(0,n.Uk)(";\n    ctx."),(0,n._)("span",{class:"hljs-title function_"},"fillText"),(0,n.Uk)("(name, "),(0,n._)("span",{class:"hljs-number"},"220"),(0,n.Uk)(", "),(0,n._)("span",{class:"hljs-number"},"70"),(0,n.Uk)(");\n    "),(0,n._)("span",{class:"hljs-variable language_"},"this"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"imageUrl"),(0,n.Uk)(" = canvas."),(0,n._)("span",{class:"hljs-title function_"},"toDataURL"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'image/png'"),(0,n.Uk)(");\n  };\nimage."),(0,n._)("span",{class:"hljs-property"},"src"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-title class_"},"Iurl"),(0,n.Uk)(";\n")])],-1),o=(0,n.uE)('<p>图片生成完成，把生成的图片加到<code>billboard</code>中，再进行一次<code>Performance</code>看看：</p><p><img src="https://pic.imgdb.cn/item/6523a27fc458853aef4529ab.jpg" alt="image.png"><br> 页面秒开了，没有卡顿！！</p><p><img src="https://pic.imgdb.cn/item/6523a287c458853aef452b9e.jpg" alt="image.png"> 标注也正常显示。</p><h2>新的问题</h2><p>考虑到客户的电脑性能不好，每次开启页面都要动态生成几百张图片，也挺浪费性能的。那就做存储吧。<br> 存后端Or前端？ 由于这些点位信息是动态配置的，有专门的页面进行管理，所以这些文本和底图会有改变的可能。这种情况把图片存在后端只能手动去控制生成图片。<br></p><h3>IndexedDB存储</h3><p>大量图片，体积是很大的，<code>Storage</code>存不了这么多，只能放到<code>WebSQL</code>或<code>IndexedDB</code>,<code>WebSQL</code>已经不维护了，那就放在<code>IndexedDB</code>吧。</p>',7),h=(0,n._)("pre",null,[(0,n._)("code",{"v-pre":"",class:"language-js"},[(0,n._)("span",{class:"hljs-comment"},"// 项目入口文件中创建并连接IndexedDB"),(0,n.Uk)("\n"),(0,n._)("span",{class:"hljs-comment"},"//FILE -> main.js"),(0,n.Uk)("\n\n"),(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" indexedDB = "),(0,n._)("span",{class:"hljs-variable language_"},"window"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"indexedDB"),(0,n.Uk)(" || "),(0,n._)("span",{class:"hljs-variable language_"},"window"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"webkitIndexedDB"),(0,n.Uk)(" || "),(0,n._)("span",{class:"hljs-variable language_"},"window"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"mozIndexedDB"),(0,n.Uk)(";\n"),(0,n._)("span",{class:"hljs-title class_"},"DBOpenRequest"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"onupgradeneeded"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-function"},[(0,n.Uk)("("),(0,n._)("span",{class:"hljs-params"},"e"),(0,n.Uk)(") =>")]),(0,n.Uk)(" {\n  "),(0,n._)("span",{class:"hljs-variable language_"},"console"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"info"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'DB upgradeneeded'"),(0,n.Uk)(")\n  "),(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" db = e."),(0,n._)("span",{class:"hljs-property"},"target"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"result"),(0,n.Uk)(";\n  "),(0,n._)("span",{class:"hljs-keyword"},"if"),(0,n.Uk)(" (!db."),(0,n._)("span",{class:"hljs-property"},"objectStoreNames"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"contains"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'buildingImage'"),(0,n.Uk)(")) {\n    db."),(0,n._)("span",{class:"hljs-title function_"},"createObjectStore"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'buildingImage'"),(0,n.Uk)(", { "),(0,n._)("span",{class:"hljs-attr"},"keyPath"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-string"},"'bsm'"),(0,n.Uk)(" });\n  }\n}\n"),(0,n._)("span",{class:"hljs-title class_"},"DBOpenRequest"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"onsuccess"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-function"},[(0,n.Uk)("("),(0,n._)("span",{class:"hljs-params"},"e"),(0,n.Uk)(") =>")]),(0,n.Uk)(" {\n  "),(0,n._)("span",{class:"hljs-variable language_"},"console"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"info"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'DB链接成功'"),(0,n.Uk)(")\n  "),(0,n._)("span",{class:"hljs-keyword"},"const"),(0,n.Uk)(" db = e."),(0,n._)("span",{class:"hljs-property"},"target"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"result"),(0,n.Uk)(";\n  "),(0,n._)("span",{class:"hljs-title class_"},"Vue"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},[(0,n._)("span",{class:"hljs-keyword"},"prototype")]),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"$DB"),(0,n.Uk)(" = db;\n\n  "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"Vue"),(0,n.Uk)("({\n    router,\n    store,\n    "),(0,n._)("span",{class:"hljs-title function_"},"beforeDestroy"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-params"}),(0,n.Uk)(") {\n      "),(0,n._)("span",{class:"hljs-title class_"},"DBOpenRequest"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"result"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"close"),(0,n.Uk)("();\n    },\n    "),(0,n._)("span",{class:"hljs-attr"},"render"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-function"},[(0,n._)("span",{class:"hljs-params"},"h"),(0,n.Uk)(" =>")]),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title function_"},"h"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-title class_"},"App"),(0,n.Uk)(")\n  }).$mount("),(0,n._)("span",{class:"hljs-string"},"'#app'"),(0,n.Uk)(");\n}\n"),(0,n._)("span",{class:"hljs-title class_"},"DBOpenRequest"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"onerror"),(0,n.Uk)(" = "),(0,n._)("span",{class:"hljs-function"},[(0,n.Uk)("("),(0,n._)("span",{class:"hljs-params"},"e"),(0,n.Uk)(") =>")]),(0,n.Uk)(" {\n  "),(0,n._)("span",{class:"hljs-variable language_"},"console"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"ERROR"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-string"},"'Can not open indexedDB'"),(0,n.Uk)(", e);\n\n  "),(0,n._)("span",{class:"hljs-keyword"},"new"),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title class_"},"Vue"),(0,n.Uk)("({\n    router,\n    store,\n    "),(0,n._)("span",{class:"hljs-title function_"},"beforeDestroy"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-params"}),(0,n.Uk)(") {\n      "),(0,n._)("span",{class:"hljs-title class_"},"DBOpenRequest"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-property"},"result"),(0,n.Uk)("."),(0,n._)("span",{class:"hljs-title function_"},"close"),(0,n.Uk)("();\n    },\n    "),(0,n._)("span",{class:"hljs-attr"},"render"),(0,n.Uk)(": "),(0,n._)("span",{class:"hljs-function"},[(0,n._)("span",{class:"hljs-params"},"h"),(0,n.Uk)(" =>")]),(0,n.Uk)(),(0,n._)("span",{class:"hljs-title function_"},"h"),(0,n.Uk)("("),(0,n._)("span",{class:"hljs-title class_"},"AppWith404"),(0,n.Uk)(")\n  }).$mount("),(0,n._)("span",{class:"hljs-string"},"'#app'"),(0,n.Uk)(");\n};\n")])],-1),k=(0,n.uE)("<p>最后： 在添加<code>entitie</code>的时候先查询库里对应的bsm存不存在，若存在，判断各类信息是否一致，一致的话使用存储的base64图片作为<code>billboard</code>的<code>image</code>；若不存在或者各类信息不一致，重新生成图片并存入库，再作为<code>billboard</code>的<code>image</code>。</p><h2>结语</h2><p>至此，Cesium加载大量entitie卡顿的问题基本解决，进入页面也能达到秒开的速度。<br> 国内对<code>CesiumJS</code>的知识的分享过少，有时候遇到问题，网上找不到答案；并且<code>CesiumJS</code>的API超级多，很难在短时间内找到想要的功能API。若有想一起学习探讨的大佬，请私信！！！ 本人对<code>CesiumJS</code>的认知就像学前端的时候刚学<code>JS</code>一样，一脸懵逼，文章中若有错误或讲得不对的，请批评指出。谢谢(●&#39;◡&#39;●)。</p>",3),j=[e,c,t,p,r,i,_,o,h,k];function U(s,a,l,e,c,t){return(0,n.wg)(),(0,n.iD)("section",null,j)}var d={components:{}},m=l(89);const u=(0,m.Z)(d,[["render",U]]);var g=u}}]);
//# sourceMappingURL=836.d4a62d3d.js.map